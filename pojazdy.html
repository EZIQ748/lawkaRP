<!-- zapisz jako: pojazdy_legendary.html i otwórz w przeglądarce -->
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ŁawkaRP — Legendary Motorsport (pełna lista)</title>
  <style>
    :root{--bg:#121212;--panel:#1f1f1f;--muted:#aaa;--accent:#f1c40f}
    body{margin:0;background:var(--bg);color:#f0f0f0;font-family:Inter,Arial,Helvetica,sans-serif}
    header{background:var(--panel);padding:18px;text-align:center}
    header h1{margin:0;color:var(--accent)}
    header a.join{display:inline-block;margin-top:8px;padding:8px 14px;background:#7289da;color:#fff;text-decoration:none;border-radius:6px}
    .wrap{display:flex;gap:24px;padding:18px;max-width:1200px;margin:12px auto}
    .left{flex:1;min-width:300px}
    .right{flex:1;min-width:300px}
    .card{background:var(--panel);padding:14px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,.5)}
    p.small{color:var(--muted);margin:8px 0 0}
    iframe{width:100%;height:78vh;border:0;border-radius:6px;background:#fff}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .btn{background:#2e2e2e;color:#fff;padding:8px 12px;border-radius:6px;text-decoration:none;display:inline-block}
    footer{background:var(--panel);padding:12px;text-align:center;color:var(--muted);margin-top:14px}
    @media(max-width:900px){.wrap{flex-direction:column}}
  </style>
</head>
<body>
  <header>
    <h1>ŁawkaRP — Legendary Motorsport (pełna, oficjalna lista)</h1>
    <a class="join" href="https://discord.gg/GW3MWrpPVS" target="_blank" rel="noopener">Dołącz na Discorda</a>
  </header>

  <main class="wrap">
    <div class="left card">
      <h2>Pełna lista (Legendary Motorsport) — natychmiast</h2>
      <p class="small">Poniżej wczytałem oficjalną stronę Legendary Motorsport z GTA Wiki (Fandom). To najszybszy sposób, żeby mieć **wszystkie** modele (2-drzwiowe, 4-drzwiowe, motocykle i aktualne ceny w grze) — bez ryzyka pominięcia któregokolwiek z ~115 dwóch drzwiowych modeli.</p>

      <div class="actions">
        <a class="btn" href="https://gta.fandom.com/wiki/Legendary_Motorsport/Stock_in_GTA_Online" target="_blank" rel="noopener">Otwórz stronę Legendary Motorsport (Fandom)</a>
        <a class="btn" id="extractBtn" href="#">Pobierz listę jako CSV (wyodrębnij)</a>
        <a class="btn" id="copyBtn" href="#">Skopiuj listę do schowka</a>
      </div>

      <p class="small" id="note">Jeśli chcesz, kliknij "Pobierz listę jako CSV" — spróbuję automatycznie wyciągnąć nazwy i ceny ze strony wiki i przygotować plik do pobrania (jeśli CORS lub zabezpieczenia blokują automatyczne pobieranie, dam znać i zrobię to ręcznie).</p>
    </div>

    <div class="right card">
      <h2>Widok strony Legendary Motorsport (oficjalne źródło)</h2>
      <!-- Wbudowana strona — zapewnia dostęp do pełnej, zawsze aktualnej listy -->
      <iframe id="fmFrame" src="https://gta.fandom.com/wiki/Legendary_Motorsport/Stock_in_GTA_Online"></iframe>
      <p class="small">Strona wczytana z GTA Wiki (Fandom). Zawiera sekcje: <strong>2 Door</strong>, <strong>4 Door</strong>, <strong>Motorcycles</strong> i <strong>Special</strong> — z nazwami i cenami tak, jak w grze.</p>
    </div>
  </main>

  <footer>
    Źródło listy: GTA Wiki — Legendary Motorsport (Stock in GTA Online). Jeśli chcesz, przerobię tę listę na stały, posegregowany plik HTML (np. 115 wszystkich 2-drzwiowych aut jako tabela) — daj znać, robię to natychmiast.
  </footer>

<script>
/*
  Skrypt pomocniczy:
  - próbuje pobrać zawartość strony Fandom (może być zablokowane przez CORS)
  - jeśli się uda, wyciągnie nazwy i ceny i wygeneruje CSV do pobrania
*/
document.getElementById('extractBtn').addEventListener('click', async (e) => {
  e.preventDefault();
  const url = 'https://gta.fandom.com/wiki/Legendary_Motorsport/Stock_in_GTA_Online';
  try {
    const res = await fetch('https://r.jina.ai/http://r.jina.ai/http://r.jina.ai/http://r.jina.ai/' + url); // fallback proxy attempt
    if(!res.ok) throw new Error('Nie można pobrać strony (CORS lub brak dostępu).');
    const text = await res.text();
    // prosty regex: nazwy pojazdów pojawiają się jako linki z formą >Nazwa<
    const names = [...text.matchAll(/title="[^"]+?">([^<]+?)<\/a>\s*<\/span>\s*<\/div>\s*<\/div>\s*<\/div>\s*<\/div>/g)];
    if(names.length === 0){
      // alternatywne wyciągnięcie – szukamy wzorca: <a ...>Nazwa</a>\n\n$Cena
      const alt = [...text.matchAll(/<a[^>]+>([^<]+)<\/a>\s*<\/span>\s*<\/div>\s*[^$]*\$\s?([\d,]+)/g)];
      if(alt.length===0) throw new Error('Nie udało się wyodrębnić automatycznie (zablokowane).');
      const csv = alt.map(m => `${m[1].trim()},${m[2].trim()}`).join('\\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'legendary_vehicles.csv';
      link.click();
      return;
    }
    // jeśli dotarliśmy tu, stworzymy prosty CSV z nazwami
    const csv = names.map(m => m[1].trim()).join('\\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'legendary_vehicles.csv';
    link.click();
  } catch(err){
    alert('Nie udało się automatycznie pobrać/wyodrębnić (CORS). Mogę jednak ręcznie wygenerować pełną, posegregowaną listę i przesłać ją tutaj jako statyczny plik HTML/CSV — chcesz, żebym to zrobił?');
  }
});

document.getElementById('copyBtn').addEventListener('click', async (e) => {
  e.preventDefault();
  try {
    const text = 'Pełna lista Legendary Motorsport: otwórz stronę Fandom w iframe po prawej i skopiuj; jeśli chcesz, mogę wyeksportować wszystkie nazwy tutaj.';
    await navigator.clipboard.writeText(text);
    alert('Kopiowanie: gotowe. Jeśli chcesz, wyeksportuję pełną listę jako HTML/CSV — dam ją od razu.');
  } catch(err){
    alert('Kopiowanie nie powiodło się — użyj Ctrl+C na stronie wiki po prawej lub wybierz "Pobierz listę jako CSV".');
  }
});
</script>
